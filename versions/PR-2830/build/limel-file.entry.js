import{r as t,c as i,h as s,g as e}from"./index-6156b4fd.js";import{t as h}from"./translations-dea847ae.js";import{c as n}from"./random-string-812b1c35.js";import{g as o,a,b as r,c as l}from"./file-metadata-9a4780e2.js";import{M as c}from"./component-bd36d795.js";import"./get-icon-props-0b65f85e.js";import"./component-8200fd05.js";import"./component-c4a88229.js";import"./ponyfill-30263d5e.js";import"./component-2424eedd.js";const d=":host{--icon-background-color:rgb(var(--contrast-400));--icon-color:rgb(var(--contrast-1100))}";const p="limel-chip-set";const f={id:null,text:null,removable:true};const m=class{constructor(s){t(this,s);this.change=i(this,"change",7);this.interact=i(this,"interact",7);this.fileInputId=n();this.handleDragEnter=t=>{this.isDraggingOverDropZone=true;this.preventAndStop(t)};this.handleDragLeave=()=>{this.isDraggingOverDropZone=false};this.handleFileDrop=t=>{this.preventAndStop(t);this.isDraggingOverDropZone=false;const i=t.dataTransfer;this.handleFile(i.files[0])};this.handleClick=t=>{if(t&&"Lime"in t&&t.Lime.chip){return}this.handleFileSelection(t)};this.value=undefined;this.label=undefined;this.required=false;this.disabled=false;this.readonly=false;this.invalid=false;this.accept="*";this.language="en";this.isDraggingOverDropZone=false;this.handleFileSelection=this.handleFileSelection.bind(this);this.handleFileChange=this.handleFileChange.bind(this);this.handleChipSetChange=this.handleChipSetChange.bind(this);this.handleFileDrop=this.handleFileDrop.bind(this);this.handleKeyDown=this.handleKeyDown.bind(this);this.handleKeyUp=this.handleKeyUp.bind(this);this.handleChipInteract=this.handleChipInteract.bind(this)}connectedCallback(){this.initialize()}componentDidLoad(){this.fileInput=this.element.shadowRoot.getElementById(this.fileInputId);this.chipSet=this.element.shadowRoot.querySelector(p);this.initialize()}initialize(){if(!this.chipSet){return}this.mdcTextField=new c(this.chipSet.shadowRoot.querySelector(".mdc-text-field"))}disconnectedCallback(){if(this.mdcTextField){this.mdcTextField.destroy()}}render(){return[s("input",{hidden:true,id:this.fileInputId,onChange:this.handleFileChange,type:"file",accept:this.accept,disabled:this.disabled||this.readonly}),s("limel-chip-set",{class:{"is-file-picker":true,"shows-dropzone":true,"highlight-dropzone":this.isDraggingOverDropZone},disabled:this.disabled,readonly:this.readonly,invalid:this.invalid,label:this.label,leadingIcon:"upload_to_cloud",language:this.language,onChange:this.handleChipSetChange,onClick:this.handleClick,onInteract:this.handleChipInteract,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,required:this.required,type:"input",value:this.chipArray,title:this.getTranslation("drag-and-drop-tips"),onDragEnter:this.handleDragEnter,onDragOver:this.preventAndStop,onDragLeave:this.handleDragLeave,onDrop:this.handleFileDrop})]}get chipArray(){if(!this.value){return[]}return[Object.assign(Object.assign({},f),{text:this.value.filename,id:this.value.id,icon:{name:o(this.value),title:a(this.value),color:r(this.value),backgroundColor:l(this.value)},href:this.value.href})]}handleKeyDown(t){if(t.code==="Tab"||t.code==="Backspace"||t.code==="Enter"){return}t.preventDefault();t.stopPropagation()}handleKeyUp(t){if(t.code==="Enter"&&!this.value){this.fileInput.click()}}handleFileSelection(t){t.stopPropagation();t.preventDefault();if(!this.value){this.fileInput.click()}}handleFileChange(t){if(this.fileInput.files.length>0){t.stopPropagation();this.handleFile(this.fileInput.files[0])}}handleFile(t){const i={id:n(),filename:t.name,contentType:t.type,size:t.size,fileContent:t};this.change.emit(i);this.chipSet.blur();this.mdcTextField.valid=true}handleChipSetChange(t){t.stopPropagation();const i=!t.detail.length?t.detail[0]:null;this.chipSet.blur();if(!i){this.fileInput.value="";this.change.emit(i);if(this.required){this.mdcTextField.valid=false}}}handleChipInteract(t){t.stopPropagation();t.preventDefault();this.interact.emit(t.detail.id)}preventAndStop(t){t.stopPropagation();t.preventDefault()}getTranslation(t){return h.get(`file.${t}`,this.language)}get element(){return e(this)}};m.style=d;export{m as limel_file};
//# sourceMappingURL=limel-file.entry.js.map