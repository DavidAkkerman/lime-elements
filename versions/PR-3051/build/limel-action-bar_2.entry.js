import{r as i,c as t,h as s,H as e,g as n}from"./index-6156b4fd.js";import{i as o}from"./isItem-b0459122.js";import{t as a}from"./translations-5ae8ec7b.js";import{h as r,g as l,p as h}from"./link-helper-2a16b323.js";import{E as d,b as c}from"./keycodes-9382910b.js";const m=":host(limel-action-bar){--action-bar-item-height:2rem;--limel-action-bar-item-text-color:var(\n      --action-bar-item-text-color,\n      rgb(var(--contrast-1100))\n  );box-sizing:border-box;display:inline-flex;align-items:center;padding:0.125rem 0.25rem;max-width:100%;border-radius:var(--action-bar-border-radius);background-color:var(--action-bar-background-color, rgb(var(--contrast-100)))}:host(limel-action-bar),.items{gap:0.25rem}@media (pointer: coarse){:host(limel-action-bar),.items{gap:0.5rem}}.items{display:inline-flex;max-width:100%;min-width:0}:host(limel-action-bar.is-full-width){width:100%}:host(limel-action-bar.is-floating){--action-bar-border-radius:100vw;border:1px solid rgb(var(--contrast-400));padding-right:0.125rem;padding-left:0.125rem;max-width:calc(100% - 2rem);box-shadow:var(--shadow-depth-16), var(--shadow-depth-8)}";const u=class{constructor(e){i(this,e);this.itemSelected=t(this,"itemSelected",7);this.firstRender=true;this.actionBarItems=[];this.renderActionBarItem=(i,t)=>s("limel-action-bar-item",{item:i,onSelect:this.handleSelect,isVisible:this.isVisible(t),role:"gridcell"});this.renderOverflowMenu=i=>{if(!(this.actions.length-this.overflowCutoff)){return}return s("limel-action-bar-overflow-menu",{openDirection:this.openDirection,items:i,onSelect:this.handleSelect,role:"gridcell"})};this.handleSelect=i=>{i.stopPropagation();if(o(i.detail)){this.itemSelected.emit(i.detail)}};this.handleIntersection=i=>{const t=i.filter((i=>i.isIntersecting));const s=i.filter((i=>!i.isIntersecting));if(this.firstRender){this.overflowCutoff=t.length}else{this.overflowCutoff=this.overflowCutoff+t.length-s.length}this.firstRender=false};this.actions=[];this.accessibleLabel=undefined;this.layout=undefined;this.openDirection=undefined;this.overflowCutoff=this.actions.length}render(){let i=[];if(this.actions.length){i=this.actions.slice(this.overflowCutoff)}return s(e,{"aria-label":this.accessibleLabel,class:{"is-full-width":this.layout==="fullWidth","is-floating":this.layout==="floating"},role:"grid"},s("div",{class:"items",role:"rowgroup"},this.actions.map(this.renderActionBarItem)),this.renderOverflowMenu(i))}connectedCallback(){}componentDidRender(){var i;if(this.haveItemsChanged()){(i=this.intersectionObserver)===null||i===void 0?void 0:i.disconnect();this.createIntersectionObserver()}}disconnectedCallback(){var i;(i=this.intersectionObserver)===null||i===void 0?void 0:i.disconnect();this.intersectionObserver=undefined;this.actionBarItems=[];this.connectedCallback=()=>this.createIntersectionObserver()}isVisible(i){return i<this.overflowCutoff}createIntersectionObserver(){const i={root:this.host.shadowRoot.querySelector(".items"),rootMargin:"0px",threshold:1};this.overflowCutoff=this.actions.length;this.firstRender=true;this.actionBarItems=[];this.intersectionObserver=new IntersectionObserver(this.handleIntersection,i);this.host.shadowRoot.querySelectorAll("limel-action-bar-item").forEach((i=>{this.observe(i)}))}observe(i){this.intersectionObserver.observe(i);this.actionBarItems.push(i)}haveItemsChanged(){const i=this.actionBarItems.some((i=>!this.host.shadowRoot.contains(i)));const t=Array.from(this.host.shadowRoot.querySelectorAll("limel-action-bar-item")).some((i=>!this.actionBarItems.includes(i)));return i||t}get host(){return n(this)}};u.style=m;const b=":host(limel-text-editor-link-menu){animation:fade 0.2s ease forwards;animation-delay:0.1s;opacity:0;display:flex;flex-direction:column;gap:0.5rem;padding:0.5rem;max-width:calc(100vw - 2rem);border-radius:0.5rem;background-color:var(--lime-elevated-surface-background-color);box-shadow:var(--shadow-depth-16)}.actions{display:flex;justify-content:end;gap:0.5rem}@keyframes fade{0%{scale:0.86;opacity:0}100%{scale:1;opacity:1}}";const f=class{constructor(s){i(this,s);this.cancel=t(this,"cancel",7);this.save=t(this,"save",7);this.linkChange=t(this,"linkChange",7);this.getTranslation=i=>a.get(i,this.language);this.validateLink=i=>{if(!r(i)){const t=h(i);return!!l(t)}return!!l(i)};this.handleKeyDown=i=>{var t;if(i.key!==d){return}if(this.saveButton){this.saveButton.focus()}i.preventDefault();if(((t=this.link)===null||t===void 0?void 0:t.href)&&!this.invalidLink){this.handleSave(i)}};this.handleCancel=i=>{if(i instanceof KeyboardEvent&&i.key!==c){return}i.stopPropagation();i.preventDefault();this.cancel.emit()};this.handleSave=i=>{i.stopPropagation();this.save.emit()};this.handleLinkInputAction=i=>{window.open(this.link.href,"_blank");i.stopPropagation()};this.handleLinkTitleChange=i=>{var t;this.emitLinkChange(i.detail,(t=this.link)===null||t===void 0?void 0:t.href)};this.handleLinkValueChange=i=>{var t;const s=i.detail;const e=this.validateLink(s);this.invalidLink=!e;this.emitLinkChange((t=this.link)===null||t===void 0?void 0:t.text,s)};this.emitLinkChange=(i,t)=>{const s={text:i,href:t};this.linkChange.emit(s)};this.link=undefined;this.language="en";this.isOpen=false;this.invalidLink=false}connectedCallback(){this.setupGlobalHandlers()}disconnectedCallback(){this.teardownGlobalHandlers()}setupGlobalHandlers(){if(this.isOpen){document.addEventListener("keyup",this.handleCancel)}}teardownGlobalHandlers(){document.removeEventListener("keyup",this.handleCancel)}componentDidLoad(){this.focusOnTextInput()}focusOnTextInput(){if(this.textInput){const i=this.textInput.shadowRoot.querySelector("input");if(i){requestAnimationFrame((()=>{i.focus()}))}}}render(){var i,t,e;return[s("limel-input-field",{label:this.getTranslation("editor-link-menu.text"),value:((i=this.link)===null||i===void 0?void 0:i.text)||"",leadingIcon:"text_cursor",onChange:this.handleLinkTitleChange,onKeyDown:this.handleKeyDown,ref:i=>this.textInput=i}),s("limel-input-field",{label:this.getTranslation("editor-link-menu.link"),value:((t=this.link)===null||t===void 0?void 0:t.href)||"",type:"text",leadingIcon:"-lime-text-link",trailingIcon:"external_link",invalid:this.invalidLink,onChange:this.handleLinkValueChange,onAction:this.handleLinkInputAction,onKeyDown:this.handleKeyDown}),s("div",{class:"actions"},s("limel-button",{label:this.getTranslation("cancel"),onClick:this.handleCancel}),s("limel-button",{primary:true,label:this.getTranslation("save"),disabled:!((e=this.link)===null||e===void 0?void 0:e.href)||this.invalidLink,onClick:this.handleSave,ref:i=>this.saveButton=i,slot:"button"}))]}};f.style=b;export{u as limel_action_bar,f as limel_text_editor_link_menu};
//# sourceMappingURL=limel-action-bar_2.entry.js.map